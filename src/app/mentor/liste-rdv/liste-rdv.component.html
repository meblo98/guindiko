<app-navbar-mentor></app-navbar-mentor>

<div class="appointments m-5">
  <div class="head d-flex justify-content-between">
    <h2>Mes Rendez-vous</h2>
    <!-- Button trigger modal -->
    <button
      type="button"
      class="btn btn-primary"
      data-bs-toggle="modal"
      data-bs-target="#exampleModal"
    >
      Planifier
    </button>

    <!-- Modal -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">
              Planification de rendez-vous
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <app-form-rdv></app-form-rdv>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row d-flex">
    <div class="col-4" *ngFor="let rdv of rendezVous">
      <div class="task mt-5" draggable="true" *ngIf="!isEditMode || selectedRdv?.id !== rdv.id">
        <div class="tags">
          <span class="tag">{{ rdv.date_rendezVous }}</span>
          <span class="tag">{{ rdv.type }}</span>
          <button class="options" (click)="enterEditMode(rdv)">
            <!-- SVG for edit icon -->
            <svg
              xml:space="preserve"
              viewBox="0 0 41.915 41.916"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              xmlns="http://www.w3.org/2000/svg"
              id="Capa_1"
              version="1.1"
              fill="#000000"
            >
              <g stroke-width="0" id="SVGRepo_bgCarrier"></g>
              <g
                stroke-linejoin="round"
                stroke-linecap="round"
                id="SVGRepo_tracerCarrier"
              ></g>
              <g id="SVGRepo_iconCarrier">
                <g>
                  <g>
                    <path
                      d="M11.214,20.956c0,3.091-2.509,5.589-5.607,5.589C2.51,26.544,0,24.046,0,20.956c0-3.082,2.511-5.585,5.607-5.585 C8.705,15.371,11.214,17.874,11.214,20.956z"
                    ></path>
                    <path
                      d="M26.564,20.956c0,3.091-2.509,5.589-5.606,5.589c-3.097,0-5.607-2.498-5.607-5.589c0-3.082,2.511-5.585,5.607-5.585 C24.056,15.371,26.564,17.874,26.564,20.956z"
                    ></path>
                    <path
                      d="M41.915,20.956c0,3.091-2.509,5.589-5.607,5.589c-3.097,0-5.606-2.498-5.606-5.589c0-3.082,2.511-5.585,5.606-5.585 C39.406,15.371,41.915,17.874,41.915,20.956z"
                    ></path>
                  </g>
                </g>
              </g>
            </svg>
          </button>
        </div>
        <p>{{ rdv.sujet }}</p>
        <p>{{ rdv.lien }}</p>
        <div class="stats">
          <div>
            <div>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <g stroke-width="0" id="SVGRepo_bgCarrier"></g>
                <g
                  stroke-linejoin="round"
                  stroke-linecap="round"
                  id="SVGRepo_tracerCarrier"
                ></g>
                <g id="SVGRepo_iconCarrier">
                  <path
                    stroke-linecap="round"
                    stroke-width="2"
                    d="M12 8V12L15 15"
                  ></path>
                  <circle stroke-width="2" r="9" cy="12" cx="12"></circle>
                </g></svg
              >{{ rdv.duree }} min
            </div>
            <div>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <g stroke-width="0" id="SVGRepo_bgCarrier"></g>
                <g
                  stroke-linejoin="round"
                  stroke-linecap="round"
                  id="SVGRepo_tracerCarrier"
                ></g>
                <g id="SVGRepo_iconCarrier">
                  <path
                    stroke-linejoin="round"
                    stroke-linecap="round"
                    stroke-width="1.5"
                    d="M16 10H16.01M12 10H12.01M8 10H8.01M3 10C3 4.64706 5.11765 3 12 3C18.8824 3 21 4.64706 21 10C21 15.3529 18.8824 17 12 17C11.6592 17 11.3301 16.996 11.0124 16.9876L7 21V16.4939C4.0328 15.6692 3 13.7383 3 10Z"
                  ></path>
                </g></svg
              >{{ rdv.lieu }}
            </div>
            <div>
              <svg
                fill="#000000"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                xmlns="http://www.w3.org/2000/svg"
                version="1.1"
                viewBox="-2.5 0 32 32"
              >
                <g stroke-width="0" id="SVGRepo_bgCarrier"></g>
                <g
                  stroke-linejoin="round"
                  stroke-linecap="round"
                  id="SVGRepo_tracerCarrier"
                ></g>
                <g id="SVGRepo_iconCarrier">
                  <g id="icomoon-ignore"></g>
                  <path
                    fill="#000000"
                    d="M0 10.284l0.505 0.36c0.089 0.064 0.92 0.621 2.604 0.621 0.27 0 0.55-0.015 0.836-0.044 3.752 4.346 6.411 7.472 7.060 8.299-1.227 2.735-1.42 5.808-0.537 8.686l0.256 0.834 7.63-7.631 8.309 8.309 0.742-0.742-8.309-8.309 7.631-7.631-0.834-0.255c-2.829-0.868-5.986-0.672-8.686 0.537-0.825-0.648-3.942-3.3-8.28-7.044 0.11-0.669 0.23-2.183-0.575-3.441l-0.352-0.549-8.001 8.001zM1.729 10.039l6.032-6.033c0.385 1.122 0.090 2.319 0.086 2.334l-0.080 0.344 0.25 0.235c4.692 4.416 8.093 7.533 8.823 8.214l0.272 0.25 0.321-0.143c2.479-1.102 5.271-1.307 7.815-0.589l-6.764 6.764-0.042 0.042-6.748 6.748c-0.719-2.544-0.515-5.336 0.589-7.815l0.143-0.321-0.25-0.272c-0.681-0.729-3.799-4.129-8.215-8.822l-0.233-0.249-0.345 0.080c-0.015 0.004-1.212 0.298-2.334-0.086zM8.915 16.914c0.096 0.097 0.096 0.255 0 0.351l-0.885 0.885c-0.048 0.048-0.112 0.073-0.176 0.073s-0.128-0.024-0.176-0.073c-0.097-0.097-0.097-0.255 0-0.351l0.885-0.885c0.096-0.096 0.255-0.096 0.351 0zM12.768 20.766c0.096 0.097 0.096 0.255 0 0.351l-0.885 0.885c-0.048 0.048-0.112 0.073-0.176 0.073s-0.128-0.024-0.176-0.073c-0.097-0.097-0.097-0.255 0-0.351l0.885-0.885c0.096-0.096 0.255-0.096 0.351 0zM10.841 18.841c0.096 0.097 0.096 0.255 0 0.351l-0.885 0.885c-0.048 0.048-0.112 0.073-0.176 0.073s-0.128-0.024-0.176-0.073c-0.097-0.097-0.097-0.255 0-0.351l0.885-0.885c0.096-0.096 0.255-0.096 0.351 0zM20.401 13.131c0.096 0.096 0.096 0.255 0 0.351l-0.885 0.885c-0.048 0.048-0.112 0.073-0.176 0.073s-0.128-0.024-0.176-0.073c-0.096-0.097-0.096-0.255 0-0.351l0.885-0.885c0.097-0.097 0.255-0.097 0.351 0z"
                  ></path>
                </g>
              </svg>
              {{ rdv.mentor.nom }}
            </div>
          </div>
        </div>

        </div>
            <!-- Formulaire d'édition -->
      <form
      class="mt-5"
      *ngIf="isEditMode && selectedRdv?.id === rdv.id"
      (ngSubmit)="saveChanges()"
    >
      <div class="form-group">
        <label for="date_rendezVous">Date du Rendez-vous</label>
        <input
          type="text"
          class="form-control"
          id="date_rendezVous"
          [(ngModel)]="selectedRdv.date_rendezVous"
          name="date_rendezVous"
          required
        />
      </div>
      <div class="form-group">
        <label for="sujet">Sujet</label>
        <input
          type="text"
          class="form-control"
          id="sujet"
          [(ngModel)]="selectedRdv.sujet"
          name="sujet"
          required
        />
      </div>
      <div class="form-group">
        <label for="type">Type</label>
        <select
          class="form-control"
          id="type"
          [(ngModel)]="selectedRdv.type"
          name="type"
          required
        >
          <option value="présentiel">Présentiel</option>
          <option value="en ligne">En ligne</option>
        </select>
      </div>
      <div class="form-group" *ngIf="selectedRdv.type === 'en ligne'">
        <label for="lien">Lien</label>
        <input
          type="text"
          class="form-control"
          id="lien"
          [(ngModel)]="selectedRdv.lien"
          name="lien"
        />
      </div>
      <div class="form-group" *ngIf="selectedRdv.type === 'présentiel'">
        <label for="lieu">Lieu</label>
        <input
          type="text"
          class="form-control"
          id="lieu"
          [(ngModel)]="selectedRdv.lieu"
          name="lieu"
        />
      </div>
      <div class="form-group">
        <label for="duree">Durée (minutes)</label>
        <input
          type="number"
          class="form-control"
          id="duree"
          [(ngModel)]="selectedRdv.duree"
          name="duree"
          required
        />
      </div>
      <div class="mt-3">
        <button type="submit" class="btn btn-success mx-2">Sauvegarder</button>
        <button type="button" class="btn btn-secondary" (click)="cancelEdit()">
          Annuler
        </button>
      </div>
    </form>
      </div>


    </div>
  </div>
