<app-navbar-mentee></app-navbar-mentee>

<!-- Forum Header -->
<div class="forum-header">
  <h1>Discussions - Informatique</h1>
  <p>Explorez les dernières discussions et sujets d'actualité liés à l'informatique.</p>
  <button class="btn btn-primary" (click)="toggleFormVisibility()">
    Publier un post
  </button>
</div>

<!-- Formulaire d'ajout de post -->
<div *ngIf="isFormVisible" class="add-post-form card mt-4 p-4">
  <h2>Ajouter un nouveau post</h2>
  <form (ngSubmit)="submitPost()">
    <div class="form-group mb-3">
      <label for="postContent">Contenu</label>
      <textarea class="form-control" id="postContent" [(ngModel)]="newPost.contenu" name="postContent" rows="4" required></textarea>
    </div>
    <div class="form-group mb-3">
      <label for="postImage">Image URL</label>
      <input type="text" class="form-control" id="postImage" [(ngModel)]="newPost.image" name="postImage">
    </div>
    <div class="d-flex justify-content-between">
      <button type="submit" class="btn btn-success">Publier</button>
      <button type="button" class="btn btn-secondary" (click)="toggleFormVisibility()">Annuler</button>
    </div>
  </form>
</div>

<!-- Liste des publications -->
<div *ngIf="posts.length > 0">
  <div *ngFor="let post of posts" class="discussion-card">
    <div class="discussion-title">{{ post.nomForum }}</div>
    <img [src]="post.image" alt="Post Image" class="discussion-image">
    <div class="discussion-body">{{ post.contenu }}</div>
    <div class="discussion-meta">Posté par {{ post.user_id }} | {{ post.createdAt | date }}</div>
    <button class="view-comments-btn" (click)="toggleComments(post.id)" [attr.data-bs-target]="'#comments' + post.id">
      Voir les commentaires
    </button>
    <div *ngIf="commentsVisible[post.id]" class="comments-container">
      <div *ngFor="let comment of comments[post.id]" class="comment-card">
        <div class="comment-author">Commenté(e) par {{ comment.user_id }} </div>
        <div class="comment-text">{{ comment.contenu }}</div>
        <div class="comment-meta">{{ comment.createdAt | date }}</div>
      </div>

      <!-- Formulaire pour ajouter un commentaire -->
      <div class="comment-form">
        <textarea [(ngModel)]="newComment[post.id]" rows="3" placeholder="Écrivez un commentaire..."></textarea>
        <button (click)="addComment(post.id)">Ajouter un commentaire</button>
      </div>
    </div>
  </div>
</div>
